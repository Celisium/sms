.include "macros.inc"

.section .text, "ax"  # 0x80005600 - 0x8036FBA0
.global InitializeUART
InitializeUART:
/* 800B5CEC 000B2C2C  7C 08 02 A6 */	mflr r0
/* 800B5CF0 000B2C30  90 01 00 04 */	stw r0, 4(r1)
/* 800B5CF4 000B2C34  94 21 FF F8 */	stwu r1, -8(r1)
/* 800B5CF8 000B2C38  80 6D 95 E4 */	lwz r3, BarnacleEnabled@sda21(r13)
/* 800B5CFC 000B2C3C  3C 03 5A 01 */	addis r0, r3, 0x5a01
/* 800B5D00 000B2C40  28 00 00 5A */	cmplwi r0, 0x5a
/* 800B5D04 000B2C44  40 82 00 0C */	bne lbl_800B5D10
/* 800B5D08 000B2C48  38 60 00 00 */	li r3, 0
/* 800B5D0C 000B2C4C  48 00 00 40 */	b lbl_800B5D4C
lbl_800B5D10:
/* 800B5D10 000B2C50  4B FD 68 19 */	bl OSGetConsoleType
/* 800B5D14 000B2C54  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 800B5D18 000B2C58  40 82 00 14 */	bne lbl_800B5D2C
/* 800B5D1C 000B2C5C  38 00 00 00 */	li r0, 0
/* 800B5D20 000B2C60  90 0D 95 E0 */	stw r0, Enabled@sda21(r13)
/* 800B5D24 000B2C64  38 60 00 02 */	li r3, 2
/* 800B5D28 000B2C68  48 00 00 24 */	b lbl_800B5D4C
lbl_800B5D2C:
/* 800B5D2C 000B2C6C  3C 60 A5 FF */	lis r3, 0xA5FF005A@ha
/* 800B5D30 000B2C70  38 03 00 5A */	addi r0, r3, 0xA5FF005A@l
/* 800B5D34 000B2C74  38 60 00 00 */	li r3, 0
/* 800B5D38 000B2C78  90 0D 95 E0 */	stw r0, Enabled@sda21(r13)
/* 800B5D3C 000B2C7C  38 00 00 01 */	li r0, 1
/* 800B5D40 000B2C80  90 6D 95 D8 */	stw r3, Chan@sda21(r13)
/* 800B5D44 000B2C84  38 60 00 00 */	li r3, 0
/* 800B5D48 000B2C88  90 0D 95 DC */	stw r0, Dev@sda21(r13)
lbl_800B5D4C:
/* 800B5D4C 000B2C8C  80 01 00 0C */	lwz r0, 0xc(r1)
/* 800B5D50 000B2C90  38 21 00 08 */	addi r1, r1, 8
/* 800B5D54 000B2C94  7C 08 03 A6 */	mtlr r0
/* 800B5D58 000B2C98  4E 80 00 20 */	blr 

.global ReadUARTN
ReadUARTN:
/* 800B5D5C 000B2C9C  38 60 00 04 */	li r3, 4
/* 800B5D60 000B2CA0  4E 80 00 20 */	blr 

.global WriteUARTN
WriteUARTN:
/* 800B5D64 000B2CA4  7C 08 02 A6 */	mflr r0
/* 800B5D68 000B2CA8  90 01 00 04 */	stw r0, 4(r1)
/* 800B5D6C 000B2CAC  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 800B5D70 000B2CB0  BF 41 00 18 */	stmw r26, 0x18(r1)
/* 800B5D74 000B2CB4  3B C3 00 00 */	addi r30, r3, 0
/* 800B5D78 000B2CB8  3B E4 00 00 */	addi r31, r4, 0
/* 800B5D7C 000B2CBC  80 AD 95 E0 */	lwz r5, Enabled@sda21(r13)
/* 800B5D80 000B2CC0  3C 05 5A 01 */	addis r0, r5, 0x5a01
/* 800B5D84 000B2CC4  28 00 00 5A */	cmplwi r0, 0x5a
/* 800B5D88 000B2CC8  41 82 00 0C */	beq lbl_800B5D94
/* 800B5D8C 000B2CCC  38 60 00 02 */	li r3, 2
/* 800B5D90 000B2CD0  48 00 01 C0 */	b lbl_800B5F50
lbl_800B5D94:
/* 800B5D94 000B2CD4  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5D98 000B2CD8  38 A0 00 00 */	li r5, 0
/* 800B5D9C 000B2CDC  80 8D 95 DC */	lwz r4, Dev@sda21(r13)
/* 800B5DA0 000B2CE0  4B FF F9 C1 */	bl EXILock
/* 800B5DA4 000B2CE4  2C 03 00 00 */	cmpwi r3, 0
/* 800B5DA8 000B2CE8  40 82 00 0C */	bne lbl_800B5DB4
/* 800B5DAC 000B2CEC  38 60 00 00 */	li r3, 0
/* 800B5DB0 000B2CF0  48 00 01 A0 */	b lbl_800B5F50
lbl_800B5DB4:
/* 800B5DB4 000B2CF4  38 9E 00 00 */	addi r4, r30, 0
/* 800B5DB8 000B2CF8  38 60 00 0D */	li r3, 0xd
/* 800B5DBC 000B2CFC  48 00 00 18 */	b lbl_800B5DD4
lbl_800B5DC0:
/* 800B5DC0 000B2D00  88 04 00 00 */	lbz r0, 0(r4)
/* 800B5DC4 000B2D04  2C 00 00 0A */	cmpwi r0, 0xa
/* 800B5DC8 000B2D08  40 82 00 08 */	bne lbl_800B5DD0
/* 800B5DCC 000B2D0C  98 64 00 00 */	stb r3, 0(r4)
lbl_800B5DD0:
/* 800B5DD0 000B2D10  38 84 00 01 */	addi r4, r4, 1
lbl_800B5DD4:
/* 800B5DD4 000B2D14  7C 1E 20 50 */	subf r0, r30, r4
/* 800B5DD8 000B2D18  7C 00 F8 40 */	cmplw r0, r31
/* 800B5DDC 000B2D1C  41 80 FF E4 */	blt lbl_800B5DC0
/* 800B5DE0 000B2D20  3C 00 A0 01 */	lis r0, 0xa001
/* 800B5DE4 000B2D24  90 01 00 14 */	stw r0, 0x14(r1)
/* 800B5DE8 000B2D28  3B 40 00 00 */	li r26, 0
/* 800B5DEC 000B2D2C  3F A0 20 01 */	lis r29, 0x2001
/* 800B5DF0 000B2D30  48 00 01 4C */	b lbl_800B5F3C
lbl_800B5DF4:
/* 800B5DF4 000B2D34  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5DF8 000B2D38  38 A0 00 03 */	li r5, 3
/* 800B5DFC 000B2D3C  80 8D 95 DC */	lwz r4, Dev@sda21(r13)
/* 800B5E00 000B2D40  4B FF F2 69 */	bl EXISelect
/* 800B5E04 000B2D44  2C 03 00 00 */	cmpwi r3, 0
/* 800B5E08 000B2D48  40 82 00 0C */	bne lbl_800B5E14
/* 800B5E0C 000B2D4C  38 00 FF FF */	li r0, -1
/* 800B5E10 000B2D50  48 00 00 5C */	b lbl_800B5E6C
lbl_800B5E14:
/* 800B5E14 000B2D54  93 A1 00 10 */	stw r29, 0x10(r1)
/* 800B5E18 000B2D58  38 81 00 10 */	addi r4, r1, 0x10
/* 800B5E1C 000B2D5C  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5E20 000B2D60  38 A0 00 04 */	li r5, 4
/* 800B5E24 000B2D64  38 C0 00 01 */	li r6, 1
/* 800B5E28 000B2D68  38 E0 00 00 */	li r7, 0
/* 800B5E2C 000B2D6C  4B FF E6 E9 */	bl EXIImm
/* 800B5E30 000B2D70  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5E34 000B2D74  4B FF EA C9 */	bl EXISync
/* 800B5E38 000B2D78  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5E3C 000B2D7C  38 81 00 10 */	addi r4, r1, 0x10
/* 800B5E40 000B2D80  38 A0 00 01 */	li r5, 1
/* 800B5E44 000B2D84  38 C0 00 00 */	li r6, 0
/* 800B5E48 000B2D88  38 E0 00 00 */	li r7, 0
/* 800B5E4C 000B2D8C  4B FF E6 C9 */	bl EXIImm
/* 800B5E50 000B2D90  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5E54 000B2D94  4B FF EA A9 */	bl EXISync
/* 800B5E58 000B2D98  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5E5C 000B2D9C  4B FF F3 39 */	bl EXIDeselect
/* 800B5E60 000B2DA0  80 01 00 10 */	lwz r0, 0x10(r1)
/* 800B5E64 000B2DA4  54 00 46 3E */	srwi r0, r0, 0x18
/* 800B5E68 000B2DA8  20 00 00 10 */	subfic r0, r0, 0x10
lbl_800B5E6C:
/* 800B5E6C 000B2DAC  2C 00 00 00 */	cmpwi r0, 0
/* 800B5E70 000B2DB0  7C 1B 03 78 */	mr r27, r0
/* 800B5E74 000B2DB4  40 80 00 0C */	bge lbl_800B5E80
/* 800B5E78 000B2DB8  3B 40 00 03 */	li r26, 3
/* 800B5E7C 000B2DBC  48 00 00 C8 */	b lbl_800B5F44
lbl_800B5E80:
/* 800B5E80 000B2DC0  2C 00 00 0C */	cmpwi r0, 0xc
/* 800B5E84 000B2DC4  40 80 00 0C */	bge lbl_800B5E90
/* 800B5E88 000B2DC8  7C 00 F8 40 */	cmplw r0, r31
/* 800B5E8C 000B2DCC  41 80 00 B0 */	blt lbl_800B5F3C
lbl_800B5E90:
/* 800B5E90 000B2DD0  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5E94 000B2DD4  38 A0 00 03 */	li r5, 3
/* 800B5E98 000B2DD8  80 8D 95 DC */	lwz r4, Dev@sda21(r13)
/* 800B5E9C 000B2DDC  4B FF F1 CD */	bl EXISelect
/* 800B5EA0 000B2DE0  2C 03 00 00 */	cmpwi r3, 0
/* 800B5EA4 000B2DE4  40 82 00 0C */	bne lbl_800B5EB0
/* 800B5EA8 000B2DE8  3B 40 00 03 */	li r26, 3
/* 800B5EAC 000B2DEC  48 00 00 98 */	b lbl_800B5F44
lbl_800B5EB0:
/* 800B5EB0 000B2DF0  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5EB4 000B2DF4  38 81 00 14 */	addi r4, r1, 0x14
/* 800B5EB8 000B2DF8  38 A0 00 04 */	li r5, 4
/* 800B5EBC 000B2DFC  38 C0 00 01 */	li r6, 1
/* 800B5EC0 000B2E00  38 E0 00 00 */	li r7, 0
/* 800B5EC4 000B2E04  4B FF E6 51 */	bl EXIImm
/* 800B5EC8 000B2E08  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5ECC 000B2E0C  4B FF EA 31 */	bl EXISync
/* 800B5ED0 000B2E10  48 00 00 54 */	b lbl_800B5F24
lbl_800B5ED4:
/* 800B5ED4 000B2E14  2C 1B 00 04 */	cmpwi r27, 4
/* 800B5ED8 000B2E18  40 80 00 0C */	bge lbl_800B5EE4
/* 800B5EDC 000B2E1C  7C 1B F8 40 */	cmplw r27, r31
/* 800B5EE0 000B2E20  41 80 00 54 */	blt lbl_800B5F34
lbl_800B5EE4:
/* 800B5EE4 000B2E24  28 1F 00 04 */	cmplwi r31, 4
/* 800B5EE8 000B2E28  40 80 00 0C */	bge lbl_800B5EF4
/* 800B5EEC 000B2E2C  7F FC FB 78 */	mr r28, r31
/* 800B5EF0 000B2E30  48 00 00 08 */	b lbl_800B5EF8
lbl_800B5EF4:
/* 800B5EF4 000B2E34  3B 80 00 04 */	li r28, 4
lbl_800B5EF8:
/* 800B5EF8 000B2E38  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5EFC 000B2E3C  7F 85 E3 78 */	mr r5, r28
/* 800B5F00 000B2E40  38 9E 00 00 */	addi r4, r30, 0
/* 800B5F04 000B2E44  38 C0 00 01 */	li r6, 1
/* 800B5F08 000B2E48  38 E0 00 00 */	li r7, 0
/* 800B5F0C 000B2E4C  4B FF E6 09 */	bl EXIImm
/* 800B5F10 000B2E50  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5F14 000B2E54  7F DE E2 14 */	add r30, r30, r28
/* 800B5F18 000B2E58  7F FC F8 50 */	subf r31, r28, r31
/* 800B5F1C 000B2E5C  7F 7C D8 50 */	subf r27, r28, r27
/* 800B5F20 000B2E60  4B FF E9 DD */	bl EXISync
lbl_800B5F24:
/* 800B5F24 000B2E64  2C 1B 00 00 */	cmpwi r27, 0
/* 800B5F28 000B2E68  41 82 00 0C */	beq lbl_800B5F34
/* 800B5F2C 000B2E6C  28 1F 00 00 */	cmplwi r31, 0
/* 800B5F30 000B2E70  40 82 FF A4 */	bne lbl_800B5ED4
lbl_800B5F34:
/* 800B5F34 000B2E74  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5F38 000B2E78  4B FF F2 5D */	bl EXIDeselect
lbl_800B5F3C:
/* 800B5F3C 000B2E7C  28 1F 00 00 */	cmplwi r31, 0
/* 800B5F40 000B2E80  40 82 FE B4 */	bne lbl_800B5DF4
lbl_800B5F44:
/* 800B5F44 000B2E84  80 6D 95 D8 */	lwz r3, Chan@sda21(r13)
/* 800B5F48 000B2E88  4B FF F9 0D */	bl EXIUnlock
/* 800B5F4C 000B2E8C  7F 43 D3 78 */	mr r3, r26
lbl_800B5F50:
/* 800B5F50 000B2E90  BB 41 00 18 */	lmw r26, 0x18(r1)
/* 800B5F54 000B2E94  80 01 00 34 */	lwz r0, 0x34(r1)
/* 800B5F58 000B2E98  38 21 00 30 */	addi r1, r1, 0x30
/* 800B5F5C 000B2E9C  7C 08 03 A6 */	mtlr r0
/* 800B5F60 000B2EA0  4E 80 00 20 */	blr 

.section .sbss, "wa"  # 0x804097C0 - 0x8040B45C
Chan:
	.skip 0x4
Dev:
	.skip 0x4
Enabled:
	.skip 0x4
BarnacleEnabled:
	.skip 0x1C
